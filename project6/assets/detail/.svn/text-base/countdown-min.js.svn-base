KISSY.add(function(f,g){function j(a){this.fm=a.format||"d,h,i,s";this.el=g(a.element);this.onProcess=a.onProcess||null;this.setLeftTime(a.leftTime);this.init()}function n(a,b,c,d){function e(){var k;if(a()!==false){l+=b;k=l+h-(new Date).getTime();c.timer=window.setTimeout(arguments.callee,k)}}var h=(new Date).getTime(),l=d?0:b;if(typeof c!=="object")c={};d?e():(c.timer=window.setTimeout(e,b));return c.timer}function m(a,b){switch(a){case "d":return b/86400|0;case "h":return i(b/3600%24|0)-(b/86400|
0)*24;case "i":return i(b%3600/60|0);case "s":return i(b%3600%60)}return 0}function i(a){return(a="00"+a).slice(-2,a.length)}g=f.all;f.augment(j,{init:function(){var a=this,b=a.fm.split(","),c=a.el,d;d=a.fields={};c[0]&&f.each(c[0].getElementsByTagName("var"),function(e,h){d[b[h]]=g(e)});this.timer=n(function(){a.onProcess&&a.onProcess(a.lt);a.render();a.subtractLeftTime()},1E3,{},true)},render:function(){var a=this.lt,b=0;if(f.indexOf(this.fields,"d")==-1&&a>=86400)b=a/86400|0;a>=0&&f.each(this.fields,
function(c,d,e){e=d=="h"&&b?b*24-0+(m(d,a)-0):m(d,a);c.html(e)})},setLeftTime:function(a){this.lt=a/1E3|0},subtractLeftTime:function(){this.lt&&this.lt--},destroy:function(){this.timer&&clearTimeout(this.timer);this.el=this.onProcess=this.timer=null}});return j});
