KISSY.add(function(e){function f(a,c){this.set({el:a,radius:c});this.draw()}function l(a){a+="";return n[1].test(a)?a.split(" ")[0]:null}function o(a,c,b,d,e,f,m,i,j){var k=document.createElement("v:roundrect");g(k).attr({arcsize:a,strokeColor:c,strokeWeight:b,stroked:d}).css({display:"block",width:e+"px",height:f+"px",position:"absolute",top:m+"px",left:i+"px",antialias:!0,zIndex:j});return k}function p(a,c){var b=document.createElement("v:fill"),d={color:a};"none"!=c&&(d.src=c,d.type="tile",d.size=
"100%,100%",g(b).addClass("vml-fill"));g(b).attr(d);return b}function s(a){var c=o(0.5,"#FFFFFF",0,!1,1,1,0,0,0),b=p("#FFFFFF","none");g(c).hide();c.appendChild(b);a.append(c)}var g=e.all,t=e.DOM,n=[/^(\.|#).+$/,/^\d+(?:px|%)/,/relative|absolute/],q=!e.UA.ie||9<=e.UA.ie;if(!q&&!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var r=document.createStyleSheet();r.addRule("v\\:roundrect","behavior: url(#default#VML);");r.addRule("v\\:fill","behavior: url(#default#VML);")}e.extend(f,
e.Base,{draw:function(){var a=this.get("el"),c=this.get("radius"),b=a.offset(),d=a.outerWidth(),f=a.outerHeight(),l=Math.min(~c.indexOf("%")?parseInt(c)/100:parseInt(c)/Math.min(d,f),1),c=a.css("backgroundColor"),m=a.css("backgroundImage").replace(/^url\(([^\)]+)\)$/,"$1").replace(/"|'/g,""),i=a.css("borderColor"),j=parseInt(a.css("borderWidth")),k="true",h={background:"transparent"};j||(i=c,j=0,k="false");"IMG"==a[0].tagName&&(m=a[0].src,h.visibility="hidden");6==e.UA.ie?h.filter="chroma(color="+
i+")":h.borderColor="transparent";for(a.css(h);a=a.parent();)if(!a[0]._ks_roundRect){!n[2].test(a.css("position"))&&a.css("position","relative");break}a.css("zIndex",+a.css("zIndex")||0);h=a.offset();b=o(l,i,j,k,d,f,b.top-h.top,b.left-h.left,a.css("zIndex")-1);d=p(c,m);b.appendChild(d);a.append(b);this.set("rect",g(b))},remove:function(){this.get("rect").remove();this.set("rect",null)}},{render:function(){var a=[].slice.apply(arguments);n[0].test(a[0]+"")||(a=[".round-rect"].concat(a));if(t.get(a[0]))if(q)(b=
l(a[1]))&&g(a[0]).each(function(a){a.css({"border-radius":b,"-moz-border-radius":b,"-webkit-border-radius":b})});else{var c,b;g(a[0]).each(function(d){d[0]._ks_roundRect&&d[0]._ks_roundRect.remove();b=a[1]||d[0].currentStyle["border-radius"];if(b=l(b))c=new f(d,b),d[0]._ks_roundRect=c});c&&s(c.get("rect").parent())}}});return f});
